<aside class="sidebar-container">
  <div class="sidebar-header">
    <img [src]="companyLogo" alt="Logo Empresa" class="logo">
    <span class="logo-text">{{ companyName }}</span>
  </div>

  <nav class="sidebar-nav">

    <a routerLink="/dashboard/overview" routerLinkActive="active" class="nav-item">
      <mat-icon>dashboard</mat-icon>
      <span>Dashboard</span>
    </a>

    <div class="nav-section"
      *ngIf="can(P.EMPLOYEES_READ_BASIC) || can(P.RECRUITMENT_MANAGE) || can(P.ONBOARDING_MANAGE) || can(P.PERFORMANCE_MANAGE)">

      <span class="nav-title">
        <mat-icon class="section-icon">people</mat-icon> Talento Humano
      </span>

      <div class="nav-submenu">
        <a *ngIf="can(P.EMPLOYEES_READ_BASIC)" routerLink="/dashboard/employees" routerLinkActive="active"
          class="nav-item">
          <mat-icon>badge</mat-icon>
          <span>Directorio</span>
        </a>

        <a *ngIf="can(P.RECRUITMENT_MANAGE)" routerLink="/dashboard/recruitment" routerLinkActive="active"
          class="nav-item">
          <mat-icon>work_outline</mat-icon>
          <span>Reclutamiento</span>
        </a>

        <a *ngIf="can(P.ONBOARDING_MANAGE)" routerLink="/dashboard/onboarding" routerLinkActive="active"
          class="nav-item">
          <mat-icon>how_to_reg</mat-icon>
          <span>Onboarding</span>
        </a>

        <a *ngIf="can(P.PERFORMANCE_MANAGE)" routerLink="/dashboard/performance" routerLinkActive="active"
          class="nav-item">
          <mat-icon>stars</mat-icon>
          <span>Evaluaciones</span>
        </a>
      </div>
    </div>

    <div class="nav-section"
      *ngIf="can(P.PROJECTS_READ) || can(P.TASKS_MY_READ) || can(P.ATTENDANCE_READ_ALL) || can(P.ATTENDANCE_MY_READ)">

      <span class="nav-title">
        <mat-icon class="section-icon">business_center</mat-icon> Operaciones
      </span>

      <div class="nav-submenu">

        <a *ngIf="can(P.PROJECTS_READ) || can(P.TASKS_MY_READ)" routerLink="/dashboard/sprints"
          routerLinkActive="active" class="nav-item">
          <mat-icon>view_kanban</mat-icon>
          <span>Sprints y Tareas</span>
        </a>

        <a *ngIf="can(P.PROJECTS_READ)" routerLink="/dashboard/goals" routerLinkActive="active" class="nav-item">
          <mat-icon>flag</mat-icon>
          <span>Metas y Objetivos</span>
        </a>

        <a *ngIf="can(P.ATTENDANCE_READ_ALL) || can(P.ATTENDANCE_MY_READ)" routerLink="/dashboard/attendance"
          routerLinkActive="active" class="nav-item">
          <mat-icon>event_available</mat-icon>
          <span>Asistencia</span>
        </a>

        <a *ngIf="can(P.TASKS_EXECUTE)" routerLink="/dashboard/timesheet" routerLinkActive="active" class="nav-item">
          <mat-icon>schedule</mat-icon>
          <span>Registro de Tiempo</span>
        </a>
      </div>
    </div>

    <div class="nav-section" *ngIf="can(P.PAYROLL_READ) || can(P.PAYROLL_MY_READ) || can(P.BENEFITS_MANAGE)">
      <span class="nav-title">
        <mat-icon class="section-icon">payments</mat-icon> Compensación
      </span>
      <div class="nav-submenu">

        <a *ngIf="can(P.PAYROLL_READ) || can(P.PAYROLL_MY_READ)" routerLink="/dashboard/payroll"
          routerLinkActive="active" class="nav-item">
          <mat-icon>receipt_long</mat-icon>
          <span>Nómina</span>
        </a>

        <a *ngIf="can(P.BENEFITS_MANAGE) || can(P.LOANS_REQUEST)" routerLink="/dashboard/benefits"
          routerLinkActive="active" class="nav-item">
          <mat-icon>card_giftcard</mat-icon>
          <span>Beneficios</span>
        </a>

        <a *ngIf="can(P.PAYROLL_READ)" routerLink="/dashboard/expenses" routerLinkActive="active" class="nav-item">
          <mat-icon>receipt</mat-icon>
          <span>Gastos y Reembolsos</span>
        </a>
      </div>
    </div>

    <div class="nav-section" *ngIf="can(P.TRAINING_MANAGE) || can(P.PERFIL_ME)">
      <span class="nav-title">
        <mat-icon class="section-icon">trending_up</mat-icon> Desarrollo
      </span>
      <div class="nav-submenu">
        <a routerLink="/dashboard/courses" routerLinkActive="active" class="nav-item">
          <mat-icon>school</mat-icon>
          <span>Capacitación</span>
        </a>
      </div>
    </div>

    <div class="nav-section" *ngIf="can(P.DOCUMENTS_MANAGE) || can(P.ASSETS_MANAGE) || can(P.PERFIL_ME)">
      <span class="nav-title">
        <mat-icon class="section-icon">inventory_2</mat-icon> Recursos
      </span>
      <div class="nav-submenu">
        <a routerLink="/dashboard/documents" routerLinkActive="active" class="nav-item">
          <mat-icon>folder</mat-icon>
          <span>Documentos</span>
        </a>

        <a *ngIf="can(P.ASSETS_MANAGE)" routerLink="/dashboard/assets" routerLinkActive="active" class="nav-item">
          <mat-icon>devices</mat-icon>
          <span>Activos y Equipos</span>
        </a>
      </div>
    </div>

    <div class="nav-section" *ngIf="can(P.REPORTS_VIEW)">
      <span class="nav-title">
        <mat-icon class="section-icon">analytics</mat-icon> Análisis
      </span>
      <div class="nav-submenu">
        <a routerLink="/dashboard/reports" routerLinkActive="active" class="nav-item">
          <mat-icon>bar_chart</mat-icon>
          <span>Reportes</span>
        </a>
      </div>
    </div>

    <div class="nav-divider"></div>

    <a routerLink="/dashboard/my-profile" routerLinkActive="active" class="nav-item">
      <mat-icon>person</mat-icon>
      <span>Mi Perfil</span>
    </a>

    <div class="nav-section" *ngIf="can(P.EMPLOYEES_READ_BASIC)">
      <span class="nav-title">
        <mat-icon class="section-icon">domain</mat-icon> Empresa
      </span>
      <div class="nav-submenu">

        <a *ngIf="can(P.BRANCHES_MANAGE)" routerLink="/dashboard/branches" routerLinkActive="active" class="nav-item">
          <mat-icon>store</mat-icon>
          <span>Sucursales / Sedes</span>
        </a>
        <a routerLink="/dashboard/organization-chart" routerLinkActive="active" class="nav-item">
          <mat-icon>account_tree</mat-icon>
          <span>Organigrama</span>
        </a>

        <a routerLink="/dashboard/policies" routerLinkActive="active" class="nav-item">
          <mat-icon>gavel</mat-icon>
          <span>Políticas y Normas</span>
        </a>
        <a routerLink="/dashboard/company-directory" routerLinkActive="active" class="nav-item">
          <mat-icon>contact_page</mat-icon>
          <span>Directorio</span>
        </a>

      </div>
    </div>

    <div class="nav-section">
      <span class="nav-title">
        <mat-icon class="section-icon">forum</mat-icon> Comunicación
      </span>
      <div class="nav-submenu">

        <a routerLink="/dashboard/announcements" routerLinkActive="active" class="nav-item">
          <mat-icon>campaign</mat-icon>
          <span>Comunicados</span>
        </a>

        <a routerLink="/dashboard/surveys" routerLinkActive="active" class="nav-item">
          <mat-icon>poll</mat-icon>
          <span>Clima & Encuestas</span>
        </a>

      </div>
    </div>

    <a *ngIf="can(P.ROLES_MANAGE) || can(P.USERS_MANAGE) || can(P.COMPANY_CONFIG)" routerLink="/dashboard/settings"
      routerLinkActive="active" class="nav-item">
      <mat-icon>settings</mat-icon>
      <span>Configuración</span>
    </a>
  </nav>

  <div class="sidebar-footer">
    <button class="logout-btn" (click)="authService.logout()">
      <mat-icon>logout</mat-icon>
      <span>Cerrar Sesión</span>
    </button>
  </div>
</aside>