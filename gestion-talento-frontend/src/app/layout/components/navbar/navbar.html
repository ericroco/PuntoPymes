<header class="navbar-container">
  <div class="page-title">
    <h1>Vista General</h1>
    <p *ngIf="!selectedBranchId">Bienvenido de nuevo, {{ displayName | titlecase }}</p>
    <p *ngIf="selectedBranchId" class="filtered-msg">
      <span class="dot"></span> Filtrando por Sucursal
    </p>
  </div>

  <div class="navbar-actions">

    <div class="branch-selector" *ngIf="canSwitchBranch">
      <mat-form-field appearance="outline" class="dense-select">
        <mat-select [value]="selectedBranchId" (selectionChange)="onBranchChange($event.value)"
          placeholder="üè¢ Todas las Sedes">

          <mat-option [value]="null">
            <span class="option-text">üè¢ Todas las Sedes</span>
          </mat-option>

          <mat-option *ngFor="let b of branches" [value]="b.id">
            <span class="option-text">üìç {{ b.nombre }}</span>
          </mat-option>

        </mat-select>
      </mat-form-field>
    </div>
    <div class="search-bar">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="search-icon">
        <path
          d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12A6 6 0 0110 4z" />
      </svg>
      <input type="text" placeholder="Buscar empleado o tarea...">
    </div>

    <button class="icon-button notification-button" [matMenuTriggerFor]="notificationMenu">
      <mat-icon>notifications</mat-icon> <span class="notification-badge" *ngIf="notificationCount > 0">{{
        notificationCount }}</span>
    </button>

    <mat-menu #notificationMenu="matMenu" xPosition="before" class="notification-panel">
      <div class="notification-header">
        <span>Notificaciones</span>
        <button mat-button color="primary" (click)="markAllRead()">Marcar le√≠das</button>
      </div>

      <div class="notification-list">
        <button mat-menu-item *ngFor="let notif of notifications" [class.unread]="!notif.read">
          <mat-icon [color]="notif.color">{{ notif.icon }}</mat-icon>
          <div class="notif-content">
            <span class="notif-title">{{ notif.title }}</span>
            <span class="notif-time">{{ notif.time }}</span>
          </div>
        </button>

        <div *ngIf="notifications.length === 0" class="empty-notif">
          Sin novedades
        </div>
      </div>
    </mat-menu>

    <div class="user-profile">
      <img [src]="userAvatar" alt="Avatar" onerror="this.src='assets/images/default-avatar.png'">
      <div class="user-info">
        <span class="user-name">{{ displayName | titlecase }}</span>
        <span class="user-role">{{ userRole }}</span>
      </div>
    </div>
  </div>
</header>