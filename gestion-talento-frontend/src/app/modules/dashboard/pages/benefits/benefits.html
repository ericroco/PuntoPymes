<div class="page-container benefits-page">
  <app-subpage-header title="Gestión de Beneficios" backRoute="/dashboard/overview">
    <button mat-stroked-button color="primary" routerLink="/dashboard/settings/payroll">
      <mat-icon>settings</mat-icon>
      Configurar Tipos de Beneficio
    </button>
  </app-subpage-header>

  <p class="description">
    Asigna o remueve beneficios y descuentos recurrentes a tus empleados de forma masiva.
    Los tipos de beneficios se crean en la Configuración de Nómina.
  </p>

  <div class="benefits-grid" @listAnimation>
    <mat-card *ngFor="let benefit of availableBenefits" class="benefit-card report-container">

      <mat-card-header>
        <mat-card-title>{{ benefit.name }}</mat-card-title>
        <mat-card-subtitle>{{ benefit.type }} Recurrente</mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <div class="adoption-kpi">
          <span class="kpi-value">{{ benefit.assignedCount }}</span>
          <span class="kpi-total">/ {{ benefit.totalEmployees }} Empleados</span>
        </div>

        <div class="progress-area">
          <span class="progress-text">{{ getAdoptionRate(benefit) | number:'1.0-0' }}% de Adopción</span>
          <mat-progress-bar mode="determinate" [value]="getAdoptionRate(benefit)"></mat-progress-bar>
        </div>
      </mat-card-content>

      <mat-card-actions align="end" class="card-actions">
        <button mat-button (click)="goToViewAssigned(benefit)">Ver Asignados</button>
        <button mat-flat-button color="primary" [routerLink]="['/dashboard/benefits/assign', benefit.id]">
          Asignar / Gestionar
        </button>
      </mat-card-actions>

    </mat-card>
  </div>

  <div *ngIf="availableBenefits.length === 0" class="no-data-placeholder">
    No hay beneficios recurrentes definidos. Ve a Configuración > Nómina para crearlos.
  </div>

</div>