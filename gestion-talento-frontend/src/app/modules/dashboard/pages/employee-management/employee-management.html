<div class="page-container">
  <header class="page-header">
    <h2>Gesti√≥n de Personal</h2>

    <div class="view-controls">
      <input type="text" placeholder="Buscar por nombre o cargo..." class="search-input" [(ngModel)]="searchTerm"
        (ngModelChange)="applyFiltersAndSort()"> <select class="filter-select" [(ngModel)]="selectedDepartment"
        (ngModelChange)="applyFiltersAndSort()">
        <option value="">Todos los Departamentos</option>
        <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
      </select>

      <button class="btn btn-secondary" (click)="toggleSort()">
        Ordenar Por: {{ sortBy.startsWith('name') ? 'Nombre' : 'Progreso' }}
        {{ sortBy.endsWith('-asc') ? '‚ñ≤' : '‚ñº' }} </button>
    </div>

    <button class="btn btn-primary" (click)="openAddEmployeeDialog()">
      <mat-icon>add_circle_outline</mat-icon>
      A√±adir Empleado
    </button>
  </header>

  <div class="employee-grid" @cardAnimation>
    <div *ngFor="let employee of filteredEmployees" class="employee-card">
      <div class="card-header">
        <img [src]="employee.avatar" alt="{{employee.name}}" class="avatar">
        <div class="name-role">
          <span class="employee-name">{{ employee.name }}</span>
          <span class="employee-role">{{ employee.role }}</span>
        </div>
        <span class="status-badge" [ngClass]="'status-' + employee.status">
          {{ employee.status === 'active' ? 'Activo' : (employee.status === 'vacation' ? 'Vacaciones' : 'Inactivo') }}
        </span>
      </div>

      <div class="card-body">
        <div class="info-row">
          <span class="label">Departamento:</span>
          <span class="value">{{ employee.department }}</span>
        </div>
        <div class="info-row kpi-row">
          <span class="label">Progreso Metas:</span>
          <div class="progress-bar-container">
            <div class="progress-bar" [style.width.%]="employee.goalProgress"></div>
          </div>
          <span class="kpi-value">{{ employee.goalProgress }}%</span>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-icon btn-primary" [routerLink]="['/dashboard/employee', employee.id]" title="Ver Perfil">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z" />
            <path fill-rule="evenodd"
              d="M.664 10.59a1.651 1.651 0 010-1.18l.877-.5d9a2.081 2.081 0 011.666.877l.745.986a1.125 1.125 0 001.357.51l1.118-.372a2.25 2.25 0 011.838.385l.794.556a1.125 1.125 0 001.036 0l.794-.556a2.25 2.25 0 011.838-.385l1.118.372a1.125 1.125 0 001.357-.51l.745-.986a2.081 2.081 0 011.666-.877l.877.5d9a1.651 1.651 0 010 1.18l-.877.5d9a2.081 2.081 0 01-1.666-.877l-.745-.986a1.125 1.125 0 00-1.357-.51l-1.118.372a2.25 2.25 0 01-1.838-.385l-.794-.556a1.125 1.125 0 00-1.036 0l-.794.556a2.25 2.25 0 01-1.838.385l-1.118-.372a1.125 1.125 0 00-1.357.51l-.745.986a2.081 2.081 0 01-1.666.877l-.877-.5d9z"
              clip-rule="evenodd" />
          </svg>
        </button>
        <button class="btn-icon" title="Editar (Placeholder)">‚úèÔ∏è</button>
        <button class="btn-icon btn-danger" title="Desactivar (Placeholder)">üóëÔ∏è</button>
      </div>
    </div>

    <div *ngIf="filteredEmployees.length === 0" class="empty-list-placeholder">
      No se encontraron empleados con los filtros aplicados.
    </div>
  </div>
</div>