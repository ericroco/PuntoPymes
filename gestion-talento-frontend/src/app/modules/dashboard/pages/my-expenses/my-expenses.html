<div class="page-container expenses-page">

    <header class="page-header">
        <div class="header-text">
            <h2>Mis Reportes de Gastos</h2>
            <p class="subtitle">Gestiona tus viáticos y reembolsos de forma sencilla.</p>
        </div>

        <button mat-flat-button color="primary" class="btn-primary" (click)="openCreateDialog()">
            <mat-icon>add</mat-icon> Nuevo Reporte
        </button>
    </header>

    <div *ngIf="isLoading" class="loading-state">
        <mat-spinner diameter="40"></mat-spinner>
        <p>Cargando información...</p>
    </div>

    <div class="empty-state" *ngIf="!isLoading && reports.length === 0">
        <div class="icon-wrapper">
            <mat-icon>receipt_long</mat-icon>
        </div>
        <h3>No tienes reportes</h3>
        <p>Crea tu primer reporte para comenzar a registrar tus viáticos y solicitar reembolsos.</p>
        <button mat-flat-button color="primary" class="btn-primary" (click)="openCreateDialog()">
            <mat-icon>add_circle</mat-icon> Crear Reporte
        </button>
    </div>

    <div class="table-wrapper mat-elevation-z2" *ngIf="!isLoading && reports.length > 0">
        <table mat-table [dataSource]="reports" class="custom-table">

            <ng-container matColumnDef="titulo">
                <th mat-header-cell *matHeaderCellDef> Reporte </th>
                <td mat-cell *matCellDef="let element">
                    <div class="report-info">
                        <span class="title">{{ element.titulo }}</span>
                        <span class="desc">{{ element.descripcion }}</span>
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="fecha">
                <th mat-header-cell *matHeaderCellDef> Fecha </th>
                <td mat-cell *matCellDef="let element">
                    <span class="date-text">{{ element.createdAt | date:'mediumDate' }}</span>
                </td>
            </ng-container>

            <ng-container matColumnDef="total">
                <th mat-header-cell *matHeaderCellDef> Total </th>
                <td mat-cell *matCellDef="let element">
                    <span class="amount-text">{{ element.total | currency }}</span>
                </td>
            </ng-container>

            <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef> Estado </th>
                <td mat-cell *matCellDef="let element">
                    <span class="status-pill" [ngClass]="'status-' + element.estado.toLowerCase()">
                        {{ element.estado | titlecase }}
                    </span>
                </td>
            </ng-container>

            <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef class="col-actions"></th>
                <td mat-cell *matCellDef="let element" class="col-actions">
                    <button mat-icon-button class="action-btn" (click)="goToDetail(element.id)"
                        [matTooltip]="element.estado === 'BORRADOR' ? 'Editar' : 'Ver Detalle'">
                        <mat-icon>{{ element.estado === 'BORRADOR' ? 'edit' : 'visibility' }}</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="hover-row"></tr>
        </table>
    </div>

</div>