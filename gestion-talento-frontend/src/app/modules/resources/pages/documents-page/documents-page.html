<div class="page-container">
    <header class="page-header">
        <div class="header-content">
            <h2>Documentos Corporativos</h2>
            <p class="subtitle">
                Gestión de recursos y archivos de la empresa.
                <span *ngIf="contextService.getBranchName()" class="branch-tag">
                    (Viendo: {{ contextService.getBranchName() }})
                </span>
            </p>
        </div>

        <button class="btn btn-primary" (click)="openUploadDialog()">
            <mat-icon>add</mat-icon>
            <span>Nuevo Documento</span>
        </button>
    </header>

    <!-- Empty State -->
    <div *ngIf="dataSource.length === 0" style="padding: 80px 20px; text-align: center;">
        <div
            style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto 24px;">
            <mat-icon style="font-size: 40px; width: 40px; height: 40px; color: #888;">folder_off</mat-icon>
        </div>
        <h3 style="margin: 0 0 12px; font-size: 22px; font-weight: 600;">Sin documentos</h3>
        <p style="color: #888; margin: 0;">No hay documentos disponibles para esta vista.</p>
    </div>

    <!-- Table -->
    <div class="table-list" *ngIf="dataSource.length > 0">
        <!-- Header -->
        <div class="table-item header">
            <span>Tipo</span>
            <span>Documento</span>
            <span>Categoría</span>
            <span>Alcance</span>
            <span>Fecha</span>
            <span>Acciones</span>
        </div>

        <!-- Rows -->
        <div *ngFor="let doc of dataSource" class="table-item">

            <!-- Tipo (Icono) -->
            <div class="doc-icon-wrapper">
                <mat-icon class="doc-icon" [class.pdf]="doc.url.endsWith('pdf')">
                    {{ doc.url.endsWith('pdf') ? 'picture_as_pdf' : 'description' }}
                </mat-icon>
            </div>

            <!-- Nombre + Descripción -->
            <div class="doc-info">
                <span class="title">{{ doc.nombre }}</span>
                <span class="desc" *ngIf="doc.descripcion">{{ doc.descripcion }}</span>
            </div>

            <!-- Categoría -->
            <div>
                <span class="category-badge">{{ doc.categoria }}</span>
            </div>

            <!-- Alcance -->
            <div class="scope-wrapper">
                <span class="scope-badge" [class.global]="!doc.sucursalId">
                    <mat-icon>{{ doc.sucursalId ? 'store' : 'public' }}</mat-icon>
                    <span>{{ doc.sucursalId ? (doc.sucursal?.nombre || 'Sede Local') : 'Global' }}</span>
                </span>
            </div>

            <!-- Fecha -->
            <span class="text-muted">{{ doc.fechaSubida | date:'dd MMM, yyyy' }}</span>

            <!-- Acciones -->
            <div class="actions">
                <button mat-icon-button class="btn-icon" (click)="download(doc.url)" title="Descargar">
                    <mat-icon>download</mat-icon>
                </button>

                <button mat-icon-button class="btn-icon btn-danger" (click)="deleteDocument(doc)" title="Eliminar">
                    <mat-icon>delete</mat-icon>
                </button>
            </div>

        </div>
    </div>
</div>